from torch.utils.data import Dataset
import pandas as pd
import numpy as np


class MalwareGenomeDataset(Dataset):
    def __init__(self, csv_file, latent_dim=215):

        self.dataset = pd.read_csv(csv_file)
        self.dataset["class"] = self.dataset["class"].replace({"S": 1, "B": 0})
        self.latent_dim = latent_dim
        print(
            len(self.dataset[self.dataset["class"] == 1]),
            len(self.dataset[self.dataset["class"] == 0]),
        )

    def __len__(self):
        return len(self.dataset)

    def __getitem__(self, idx):
        vector = np.array(self.dataset.iloc[idx, : self.latent_dim])
        label = self.dataset.iloc[idx, self.latent_dim]

        sample = {"feature_vector": vector, "label": label}

        return sample
